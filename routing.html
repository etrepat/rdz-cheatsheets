<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>routing.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="migrations.html">migrations.rb</a>
          <a class="source" href="models.html">models.rb</a>
          <a class="source" href="queries.html">queries.rb</a>
          <a class="source" href="routing.html">routing.rb</a>
          <a class="source" href="rvm.html">rvm.rb</a>
          <a class="source" href="setup.html">setup.rb</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>routing.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p>Una ruta, conecta una adreça URL a una acció en un controlador.</p>

<p>Es configuren en <code>config/routes.rb</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-Rutes_bàsiques'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Rutes_bàsiques">&#182;</a>
        </div>
        <h3>Rutes bàsiques</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="no">YourApp</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:posts</span>
  <span class="n">match</span> <span class="s1">&#39;/all&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts#index&#39;</span>
  <span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;home#index&quot;</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-Rutes_anidades'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Rutes_anidades">&#182;</a>
        </div>
        <h3>Rutes anidades</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">namespace</span> <span class="ss">:api</span> <span class="k">do</span>
  <span class="n">namespace</span> <span class="ss">:internal</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:accounts</span> <span class="k">do</span>
      <span class="n">resources</span> <span class="ss">:orders</span>
      <span class="n">member</span> <span class="k">do</span>
        <span class="n">get</span>   <span class="ss">:summary</span>
        <span class="n">post</span>  <span class="ss">:suspend</span>
      <span class="k">end</span>
      <span class="n">post</span> <span class="ss">:confirm</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="ss">:member</span>
      <span class="n">collection</span> <span class="k">do</span>
        <span class="n">get</span> <span class="ss">:pending</span>
      <span class="k">end</span>
      <span class="n">get</span> <span class="ss">:blocked</span><span class="p">,</span> <span class="ss">:on</span> <span class="o">=&gt;</span> <span class="ss">:collection</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-Paràmetres_opcionals'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Paràmetres_opcionals">&#182;</a>
        </div>
        <h3>Paràmetres opcionals</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/posts(/:yy(:mm))&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts#index&#39;</span>

<span class="k">class</span> <span class="nc">PostsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="n">params</span><span class="o">[</span><span class="ss">:yy</span><span class="o">]</span>
    <span class="n">params</span><span class="o">[</span><span class="ss">:mm</span><span class="o">]</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-Redirecció'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Redirecció">&#182;</a>
        </div>
        <h3>Redirecció</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/sign_out&#39;</span>     <span class="o">=&gt;</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/signout&#39;</span><span class="p">)</span>
<span class="n">match</span> <span class="s1">&#39;/users/:name&#39;</span>  <span class="o">=&gt;</span> <span class="n">redirect</span> <span class="p">{</span> <span class="o">|</span><span class="n">params</span><span class="o">|</span> <span class="s2">&quot;/</span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">}</span>
<span class="n">match</span> <span class="s1">&#39;/google&#39;</span>       <span class="o">=&gt;</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;http://www.google.com&#39;</span><span class="p">)</span></pre></div>
      </td>
    </tr>
    <tr id='section-Rutes_amb_nom_(Named_routes)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Rutes_amb_nom_(Named_routes)">&#182;</a>
        </div>
        <h3>Rutes amb nom (Named routes)</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p>Ens dona accés als helpers <code>sign_in_path</code> i <code>sign_in_url</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/sign_in&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;session#new&#39;</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="s1">&#39;sign_in&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>Ens genera els helpers <code>reset_password_path(:token)</code> i
<code>reset_password_url(:token)</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/reset_password/:token&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;users#reset_password&#39;</span><span class="p">,</span>
  <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="s1">&#39;reset_password&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-Rutes_Rack_(Rack_Routing)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Rutes_Rack_(Rack_Routing)">&#182;</a>
        </div>
        <h3>Rutes Rack (Rack Routing)</h3>

<p>Podem enllaçar punts d'entrada arbitràris del nostre esquema de rutes
amb codi Rack o altres aplicacions (compatibles amb Rack)</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">get</span> <span class="s1">&#39;/hello&#39;</span>          <span class="o">=&gt;</span> <span class="nb">proc</span> <span class="p">{</span> <span class="o">|</span><span class="n">env</span><span class="o">|</span> <span class="o">[</span><span class="mi">200</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;Hola Rack!&quot;</span><span class="o">]</span> <span class="p">}</span>
<span class="n">get</span> <span class="s1">&#39;/rack_endpoint&#39;</span>  <span class="o">=&gt;</span> <span class="no">PostsController</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="ss">:index</span><span class="p">)</span>
<span class="n">get</span> <span class="s1">&#39;/rack_app&#39;</span>       <span class="o">=&gt;</span> <span class="no">CustomRackApp</span></pre></div>
      </td>
    </tr>
    <tr id='section-Restriccions_(Constraints)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Restriccions_(Constraints)">&#182;</a>
        </div>
        <h3>Restriccions (Constraints)</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/:year&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts#index&#39;</span><span class="p">,</span> <span class="ss">:constraints</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:year</span> <span class="o">=&gt;</span> <span class="sr">/\d{4}/</span><span class="p">}</span>

<span class="n">constraints</span><span class="p">(</span><span class="ss">:host</span> <span class="o">=&gt;</span> <span class="sr">/localhost/</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:posts</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p><code>IpRestrictor</code> ha d'implementar el mètode <code>self.matches?(request)</code></p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">constraints</span> <span class="no">IpRestrictor</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s1">&#39;admin/accounts&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;secret#accounts&#39;</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-Ruta_&amp;ldquo;Legacy&amp;rdquo;'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Ruta_&amp;ldquo;Legacy&amp;rdquo;">&#182;</a>
        </div>
        <h3>Ruta &ldquo;Legacy&rdquo;</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-13">&#182;</a>
        </div>
        <p>Comentada per defecte. És una ruta <em>catch all</em>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">match</span> <span class="s1">&#39;/:controller(/:action(/:id(.:format)))&#39;</span></pre></div>
      </td>
    </tr>
    <tr id='section-Àmbit_(scope)'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Àmbit_(scope)">&#182;</a>
        </div>
        <h3>Àmbit (scope)</h3>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-15'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-15">&#182;</a>
        </div>
        <p>Requereix del paràmetre token per a obtenir els recursos que defineix i ha
de tenir 5 caràcters alfanumèrics</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">scope</span> <span class="s1">&#39;:token&#39;</span><span class="p">,</span> <span class="ss">:token</span> <span class="o">=&gt;</span> <span class="sr">/\w{5}/</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:rooms</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:meetings</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-16'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-16">&#182;</a>
        </div>
        <p>En aquestes rutes <code>:locale</code> és opcional</p>

      </td>
      <td class=code>
        <div class='highlight'><pre><span class="n">scope</span> <span class="s1">&#39;(:locale)&#39;</span><span class="p">,</span> <span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="sr">/en|es/</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:posts</span>
  <span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts#index&#39;</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
